---
# generated by https://github.com/hashicorp/terraform-plugin-docs
page_title: "gcore_cdn_rule Resource - terraform-provider-gcore"
subcategory: ""
description: |-
  Represent cdn resource rule
---

# gcore_cdn_rule (Resource)

Represent cdn resource rule

## Example Usage

```terraform
provider gcore {
  permanent_api_token = "251$d3361.............1b35f26d8"
}

resource "gcore_cdn_rule" "cdn_example_com_rule_1" {
  resource_id = gcore_cdn_resource.cdn_example_com.id
  name        = "All PNG images"
  rule        = "/folder/images/*.png"
  rule_type   = 0
  weight      = 0

  options {
    edge_cache_settings {
      default = "14d"
    }
    browser_cache_settings {
      value = "14d"
    }
    redirect_http_to_https {
      value = true
    }
    request_limiter {
      rate_unit = "r/s"
      rate = 5
      burst = 1
    }
    gzip_on {
      value = true
    }
    cors {
      value = [
        "*"
      ]
    }
    rewrite {
      body = "/(.*) /$1"
    }
    ignore_query_string {
      value = true
    }
  }
}

resource "gcore_cdn_rule" "cdn_example_com_rule_2" {
  resource_id     = gcore_cdn_resource.cdn_example_com.id
  name            = "All JS scripts"
  rule            = "/folder/images/*.js"
  rule_type       = 0
  weight          = 0
  origin_protocol = "HTTP"

  options {
    redirect_http_to_https {
      enabled = false
      value   = true
    }
    gzip_on {
      enabled = false
      value   = true
    }
    query_params_whitelist {
      value = [
        "abc",
      ]
    }
  }
}

resource "gcore_cdn_rule" "cdn_example_com_rule_3" {
  resource_id     = gcore_cdn_resource.cdn_example_com.id
  name            = "Block all png images"
  rule            = "*.png"
  rule_type       = 0
  weight          = 0
  origin_protocol = "HTTP"

  options {
    force_return {
      code = 404
      body = "Not found."
    }
  }
}

resource "gcore_cdn_origingroup" "origin_group_1" {
  name     = "origin_group_1"
  use_next = true
  origin {
    source  = "example.com"
    enabled = true
  }
}

resource "gcore_cdn_resource" "cdn_example_com" {
  cname               = "cdn.example.com"
  origin_group        = gcore_cdn_origingroup.origin_group_1.id
  origin_protocol     = "MATCH"
  secondary_hostnames = ["cdn2.example.com"]
}
```

<!-- schema generated by tfplugindocs -->
## Schema

### Required

- `name` (String) Rule name
- `resource_id` (Number)
- `rule` (String) A pattern that defines when the rule is triggered. By default, we add a leading forward slash to any rule pattern. Specify a pattern without a forward slash.
- `rule_type` (Number) Type of rule. The rule is applied if the requested URI matches the rule pattern. It has two possible values: Type 0 — RegEx. Must start with '^/' or '/'. Type 1 — RegEx. Legacy type. Note that for this rule type we automatically add / to each rule pattern before your regular expression. Please use Type 0.

### Optional

- `active` (Boolean) The setting allows to enable or disable a Rule. If not specified, it will be enabled.
- `options` (Block List, Max: 1) Each option in CDN rule settings. Each option added to CDN rule settings should have the following mandatory request fields: enabled, value. (see [below for nested schema](#nestedblock--options))
- `origin_group` (Number) ID of the Origins Group. Use one of your Origins Group or create a new one. You can use either 'origin' parameter or 'originGroup' in the resource definition.
- `origin_protocol` (String) This option defines the protocol that will be used by CDN servers to request content from an origin source. If not specified, it will be inherit from resource. Possible values are: HTTPS, HTTP, MATCH.
- `weight` (Number) Rule weight that determines rule execution order: from the smallest (0) to the highest.

### Read-Only

- `id` (String) The ID of this resource.

<a id="nestedblock--options"></a>
### Nested Schema for `options`

Optional:

- `allowed_http_methods` (Block List, Max: 1) Specify allowed HTTP methods. (see [below for nested schema](#nestedblock--options--allowed_http_methods))
- `brotli_compression` (Block List, Max: 1) Brotli compression option allows to compress content with brotli on the CDN's end. CDN servers will request only uncompressed content from the origin. (see [below for nested schema](#nestedblock--options--brotli_compression))
- `browser_cache_settings` (Block List, Max: 1) Specify the cache expiration time for customers' browsers in seconds. (see [below for nested schema](#nestedblock--options--browser_cache_settings))
- `cache_http_headers` (Block List, Max: 1) Legacy option. Use the response_headers_hiding_policy option instead. (see [below for nested schema](#nestedblock--options--cache_http_headers))
- `cors` (Block List, Max: 1) CORS header support option adds the Access-Control-Allow-Origin header to responses from CDN servers. (see [below for nested schema](#nestedblock--options--cors))
- `country_acl` (Block List, Max: 1) Country access policy enables control access to content for specified countries. (see [below for nested schema](#nestedblock--options--country_acl))
- `disable_cache` (Block List, Max: 1) Option enables browser caching. When enabled, content caching is completely disabled. (see [below for nested schema](#nestedblock--options--disable_cache))
- `disable_proxy_force_ranges` (Block List, Max: 1) The option allows getting 206 responses regardless settings of an origin source. Enabled by default. (see [below for nested schema](#nestedblock--options--disable_proxy_force_ranges))
- `edge_cache_settings` (Block List, Max: 1) The cache expiration time for CDN servers. (see [below for nested schema](#nestedblock--options--edge_cache_settings))
- `fetch_compressed` (Block List, Max: 1) Option allows to enable fetch compressed. CDN request and cache already compressed content. Your server should support compression. CDN servers will not ungzip your content even if a user's browser doesn't accept compression (nowadays almost all browsers support it). (see [below for nested schema](#nestedblock--options--fetch_compressed))
- `follow_origin_redirect` (Block List, Max: 1) Enable redirection from origin. If the origin server returns a redirect, the option allows the CDN to pull the requested content from the origin server that was returned in the redirect. (see [below for nested schema](#nestedblock--options--follow_origin_redirect))
- `force_return` (Block List, Max: 1) Allows to apply custom HTTP code to the CDN content. Specify HTTP-code you need and text or URL if you are going to set up redirect. (see [below for nested schema](#nestedblock--options--force_return))
- `forward_host_header` (Block List, Max: 1) When a CDN requests content from an origin server, the option allows to forward the Host header used in the request made to a CDN. (see [below for nested schema](#nestedblock--options--forward_host_header))
- `gzip_on` (Block List, Max: 1) GZip compression option allows to compress content with gzip on the CDN`s end. CDN servers will request only uncompressed content from the origin. (see [below for nested schema](#nestedblock--options--gzip_on))
- `host_header` (Block List, Max: 1) Option allows to set Host header that CDN servers use when request content from an origin server. Your server must be able to process requests with the chosen header. If the option is NULL, Host Header value is taken from the parent CDN resource's value. (see [below for nested schema](#nestedblock--options--host_header))
- `ignore_cookie` (Block List, Max: 1) By default, files pulled from an origin source with cookies are not cached in a CDN. Enable this option to cache such objects. (see [below for nested schema](#nestedblock--options--ignore_cookie))
- `ignore_query_string` (Block List, Max: 1) Ignore query string option determines how files with different query strings will be cached: either as one object (option is enabled) or as different objects (option is disabled). (see [below for nested schema](#nestedblock--options--ignore_query_string))
- `image_stack` (Block List, Max: 1) Image stack option allows transforming JPG and PNG images (such as resizing or cropping) and automatically converting them to WebP or AVIF format. It is a paid option. (see [below for nested schema](#nestedblock--options--image_stack))
- `ip_address_acl` (Block List, Max: 1) IP access policy option allows to control access to the CDN Resource content for specific IP addresses. (see [below for nested schema](#nestedblock--options--ip_address_acl))
- `limit_bandwidth` (Block List, Max: 1) The option allows to control the download speed per connection. (see [below for nested schema](#nestedblock--options--limit_bandwidth))
- `proxy_cache_methods_set` (Block List, Max: 1) Allows caching for GET, HEAD and POST requests. (see [below for nested schema](#nestedblock--options--proxy_cache_methods_set))
- `proxy_connect_timeout` (Block List, Max: 1) The option allows you to control the time limit for establishing a connection with the origin server. (see [below for nested schema](#nestedblock--options--proxy_connect_timeout))
- `proxy_read_timeout` (Block List, Max: 1) The option allows you to control the time limit for receiving a partial response from the origin server. (see [below for nested schema](#nestedblock--options--proxy_read_timeout))
- `query_params_blacklist` (Block List, Max: 1) Specify list of query strings. Files with those query strings will be cached as one object. (see [below for nested schema](#nestedblock--options--query_params_blacklist))
- `query_params_whitelist` (Block List, Max: 1) Specify list of query strings. Files with those query strings will be cached as different objects. (see [below for nested schema](#nestedblock--options--query_params_whitelist))
- `redirect_http_to_https` (Block List, Max: 1) When enabled, HTTP requests are redirected to HTTPS. (see [below for nested schema](#nestedblock--options--redirect_http_to_https))
- `redirect_https_to_http` (Block List, Max: 1) When enabled, HTTPS requests are redirected to HTTP. (see [below for nested schema](#nestedblock--options--redirect_https_to_http))
- `referrer_acl` (Block List, Max: 1) Referrer access policy option allows to control access to the CDN Resource content for specified domain names. (see [below for nested schema](#nestedblock--options--referrer_acl))
- `request_limiter` (Block List, Max: 1) It allows to limit the amount of HTTP requests (see [below for nested schema](#nestedblock--options--request_limiter))
- `response_headers_hiding_policy` (Block List, Max: 1) Define HTTP headers (specified at an origin server) that a CDN server hides from the response. (see [below for nested schema](#nestedblock--options--response_headers_hiding_policy))
- `rewrite` (Block List, Max: 1) Rewrite option changes and redirects the requests from the CDN to the origin. It operates according to the Nginx configuration. (see [below for nested schema](#nestedblock--options--rewrite))
- `secure_key` (Block List, Max: 1) The option allows configuring an access with tokenized URLs. It makes impossible to access content without a valid (unexpired) hash key. When enabled, you need to specify a key that you use to generate a token. (see [below for nested schema](#nestedblock--options--secure_key))
- `slice` (Block List, Max: 1) When enabled, files larger than 10 MB are requested and cached in parts (no larger than 10 MB each). It reduces time to first byte. The origin must support HTTP Range requests. (see [below for nested schema](#nestedblock--options--slice))
- `sni` (Block List, Max: 1) Specify the SNI (Server Name Indication). SNI (Server Name Indication) is generally only required if your origin is using shared hosting or does not have a dedicated IP address. If the origin server presents multiple certificates, SNI allows the origin server to know which certificate to use for the connection. The option works only if originProtocol parameter is HTTPS or MATCH. (see [below for nested schema](#nestedblock--options--sni))
- `stale` (Block List, Max: 1) The list of errors which Always Online option is applied for. (see [below for nested schema](#nestedblock--options--stale))
- `static_headers` (Block List, Max: 1) Legacy option. Use the static_response_headers option instead. (see [below for nested schema](#nestedblock--options--static_headers))
- `static_request_headers` (Block List, Max: 1) Specify custom HTTP Headers for a CDN server to add to request. (see [below for nested schema](#nestedblock--options--static_request_headers))
- `static_response_headers` (Block List, Max: 1) Specify custom HTTP Headers that a CDN server adds to a response. (see [below for nested schema](#nestedblock--options--static_response_headers))
- `user_agent_acl` (Block List, Max: 1) User agents policy option allows to control access to the content for specified user-agent. (see [below for nested schema](#nestedblock--options--user_agent_acl))
- `waf` (Block List, Max: 1) Option allows to enable Basic WAF to protect you against the most common threats. (see [below for nested schema](#nestedblock--options--waf))
- `websockets` (Block List, Max: 1) WebSockets option allows WebSockets connections to an origin server. (see [below for nested schema](#nestedblock--options--websockets))

<a id="nestedblock--options--allowed_http_methods"></a>
### Nested Schema for `options.allowed_http_methods`

Required:

- `value` (Set of String) Available methods: GET, HEAD, POST, PUT, PATCH, DELETE, OPTIONS.

Optional:

- `enabled` (Boolean)


<a id="nestedblock--options--brotli_compression"></a>
### Nested Schema for `options.brotli_compression`

Required:

- `value` (Set of String) Specify the content-type for each type of content you wish to have compressed.

Optional:

- `enabled` (Boolean)


<a id="nestedblock--options--browser_cache_settings"></a>
### Nested Schema for `options.browser_cache_settings`

Optional:

- `enabled` (Boolean)
- `value` (String) Use '0s' to disable caching. The value applies for a response with codes 200, 201, 204, 206, 301, 302, 303, 304, 307, 308.


<a id="nestedblock--options--cache_http_headers"></a>
### Nested Schema for `options.cache_http_headers`

Required:

- `value` (Set of String) List HTTP Headers that must be included in the response.

Optional:

- `enabled` (Boolean)


<a id="nestedblock--options--cors"></a>
### Nested Schema for `options.cors`

Required:

- `value` (Set of String) Specify a value of the Access-Control-Allow-Origin header. Possible values: '*', '$http_origin', 'example.com'.

Optional:

- `always` (Boolean) Specify if the Access-Control-Allow-Origin header should be added to a response from CDN regardless of response code.
- `enabled` (Boolean)


<a id="nestedblock--options--country_acl"></a>
### Nested Schema for `options.country_acl`

Required:

- `excepted_values` (Set of String) List of countries according to ISO-3166-1.
- `policy_type` (String) Possible values: allow, deny.

Optional:

- `enabled` (Boolean)


<a id="nestedblock--options--disable_cache"></a>
### Nested Schema for `options.disable_cache`

Required:

- `value` (Boolean)

Optional:

- `enabled` (Boolean)


<a id="nestedblock--options--disable_proxy_force_ranges"></a>
### Nested Schema for `options.disable_proxy_force_ranges`

Required:

- `value` (Boolean)

Optional:

- `enabled` (Boolean)


<a id="nestedblock--options--edge_cache_settings"></a>
### Nested Schema for `options.edge_cache_settings`

Optional:

- `custom_values` (Map of String) Specify caching time in seconds ('0s', '600s' for example) for a response with specific response code ('304', '404' for example). Use 'any' to specify caching time for all response codes. Use '0s' to disable caching for a specific response code. These settings have a higher priority than the value field.
- `default` (String) Content will be cached according to origin cache settings. The value applies for a response with codes 200, 201, 204, 206, 301, 302, 303, 304, 307, 308, if an origin server does not have caching HTTP headers. Responses with other codes will not be cached.
- `enabled` (Boolean)
- `value` (String) Specify caching time for the response with codes 200, 206, 301, 302. Responses with codes 4xx, 5xx will not be cached. Use '0s' to disable caching. Use custom_values field to specify a custom caching time for a response with specific codes.


<a id="nestedblock--options--fetch_compressed"></a>
### Nested Schema for `options.fetch_compressed`

Required:

- `value` (Boolean)

Optional:

- `enabled` (Boolean)


<a id="nestedblock--options--follow_origin_redirect"></a>
### Nested Schema for `options.follow_origin_redirect`

Required:

- `codes` (Set of Number) Specify the redirect status code that the origin server returns. Possible values: 301, 302, 303, 307, 308.

Optional:

- `enabled` (Boolean)


<a id="nestedblock--options--force_return"></a>
### Nested Schema for `options.force_return`

Required:

- `code` (Number) HTTP response status code. Available codes: 100 <= value <= 599. Reserved codes: 408, 444, 477, 494, 495, 496, 497, 499

Optional:

- `body` (String) Response text or URL if you're going to set up redirection. Max length = 100.
- `enabled` (Boolean)


<a id="nestedblock--options--forward_host_header"></a>
### Nested Schema for `options.forward_host_header`

Required:

- `value` (Boolean)

Optional:

- `enabled` (Boolean)


<a id="nestedblock--options--gzip_on"></a>
### Nested Schema for `options.gzip_on`

Required:

- `value` (Boolean)

Optional:

- `enabled` (Boolean)


<a id="nestedblock--options--host_header"></a>
### Nested Schema for `options.host_header`

Required:

- `value` (String)

Optional:

- `enabled` (Boolean)


<a id="nestedblock--options--ignore_cookie"></a>
### Nested Schema for `options.ignore_cookie`

Required:

- `value` (Boolean)

Optional:

- `enabled` (Boolean)


<a id="nestedblock--options--ignore_query_string"></a>
### Nested Schema for `options.ignore_query_string`

Required:

- `value` (Boolean)

Optional:

- `enabled` (Boolean)


<a id="nestedblock--options--image_stack"></a>
### Nested Schema for `options.image_stack`

Required:

- `quality` (Number) Quality settings for JPG and PNG images. Specify a value from 1 to 100. The higher the value, the better the image quality and the larger the file size after conversion.

Optional:

- `avif_enabled` (Boolean) If enabled, JPG and PNG images automatically convert to AVIF format when supported by the end users browser.
- `enabled` (Boolean)
- `png_lossless` (Boolean) Represents compression without quality loss for PNG format.
- `webp_enabled` (Boolean) If enabled, JPG and PNG images automatically convert to WebP format when supported by the end users browser.


<a id="nestedblock--options--ip_address_acl"></a>
### Nested Schema for `options.ip_address_acl`

Required:

- `excepted_values` (Set of String) Specify list of IP address with a subnet mask.
- `policy_type` (String) Possible values: allow, deny.

Optional:

- `enabled` (Boolean)


<a id="nestedblock--options--limit_bandwidth"></a>
### Nested Schema for `options.limit_bandwidth`

Required:

- `limit_type` (String) The way of controlling the download speed per each connection. Possible values are: static, dynamic.

Optional:

- `buffer` (Number) Amount of downloaded data after which the user will be rate limited.
- `enabled` (Boolean)
- `speed` (Number) Maximum download speed per connection. Must be greater than 0.


<a id="nestedblock--options--proxy_cache_methods_set"></a>
### Nested Schema for `options.proxy_cache_methods_set`

Required:

- `value` (Boolean)

Optional:

- `enabled` (Boolean)

<a id="nestedblock--options--proxy_connect_timeout"></a>
### Nested Schema for `options.proxy_connect_timeout`

Required:

- `value` (Map of String) Specify time in seconds ('1s', '5s' for example).

Optional:

- `enabled` (Boolean)

<a id="nestedblock--options--proxy_read_timeout"></a>
### Nested Schema for `options.proxy_read_timeout`

Required:

- `value` (Map of String) Specify time in seconds ('1s', '30s' for example).

Optional:

- `enabled` (Boolean)

<a id="nestedblock--options--query_params_blacklist"></a>
### Nested Schema for `options.query_params_blacklist`

Required:

- `value` (Set of String)

Optional:

- `enabled` (Boolean)


<a id="nestedblock--options--query_params_whitelist"></a>
### Nested Schema for `options.query_params_whitelist`

Required:

- `value` (Set of String)

Optional:

- `enabled` (Boolean)


<a id="nestedblock--options--redirect_http_to_https"></a>
### Nested Schema for `options.redirect_http_to_https`

Required:

- `value` (Boolean)

Optional:

- `enabled` (Boolean)


<a id="nestedblock--options--redirect_https_to_http"></a>
### Nested Schema for `options.redirect_https_to_http`

Required:

- `value` (Boolean)

Optional:

- `enabled` (Boolean)


<a id="nestedblock--options--referrer_acl"></a>
### Nested Schema for `options.referrer_acl`

Required:

- `excepted_values` (Set of String) Specify list of domain names or wildcard domains (without http:// or https://). For example, example.com or *.example.com.
- `policy_type` (String) Possible values: allow, deny.

Optional:

- `enabled` (Boolean)


<a id="nestedblock--options--request_limiter"></a>
### Nested Schema for `options.request_limiter`

Required:

- `burst` (Number)
- `rate` (Number)

Optional:

- `delay` (Number)
- `enabled` (Boolean)
- `rate_unit` (String)


<a id="nestedblock--options--response_headers_hiding_policy"></a>
### Nested Schema for `options.response_headers_hiding_policy`

Required:

- `excepted` (Set of String) List of HTTP headers. The following required headers cannot be hidden from response: Connection, Content-Length, Content-Type, Date, Server.
- `mode` (String) Specify a mode of hiding HTTP headers from the response. Possible values are: hide, show.

Optional:

- `enabled` (Boolean)


<a id="nestedblock--options--rewrite"></a>
### Nested Schema for `options.rewrite`

Required:

- `body` (String) The pattern for Rewrite. At least one group should be specified. For Example: /rewrite_from/(.*) /rewrite_to/$1

Optional:

- `enabled` (Boolean)
- `flag` (String) Define flag for the Rewrite option. Possible values: last, break, redirect, permanent.


<a id="nestedblock--options--secure_key"></a>
### Nested Schema for `options.secure_key`

Required:

- `key` (String) A key generated on your side that will be used for URL signing.
- `type` (Number) Specify the type of URL Signing. It can be either 0 or 2. Type 0 - includes end user's IP to secure token generation. Type 2 - excludes end user's IP from secure token generation.

Optional:

- `enabled` (Boolean)


<a id="nestedblock--options--slice"></a>
### Nested Schema for `options.slice`

Required:

- `value` (Boolean)

Optional:

- `enabled` (Boolean)


<a id="nestedblock--options--sni"></a>
### Nested Schema for `options.sni`

Optional:

- `custom_hostname` (String) Custom SNI hostname. Required if sni_type is set to 'custom'.
- `enabled` (Boolean)
- `sni_type` (String) Specify SNI type. Possible values: dynamic, custom. dynamic - SNI hostname depends on the hostHeader and the forward_host_header options. custom - custom SNI hostname.


<a id="nestedblock--options--stale"></a>
### Nested Schema for `options.stale`

Required:

- `value` (Set of String) Possible values: error, http_403, http_404, http_429, http_500, http_502, http_503, http_504, invalid_header, timeout, updating.

Optional:

- `enabled` (Boolean)


<a id="nestedblock--options--static_headers"></a>
### Nested Schema for `options.static_headers`

Required:

- `value` (Map of String)

Optional:

- `enabled` (Boolean)


<a id="nestedblock--options--static_request_headers"></a>
### Nested Schema for `options.static_request_headers`

Required:

- `value` (Map of String) Header name is restricted to 255 symbols and can contain latin letters (A-Z, a-z), numbers (0-9), dashes, and underscores. Header value is restricted to 512 symbols and can contain latin letters (a-z), numbers (0-9), spaces, underscores and symbols (-/.:). Space can be used only between words.

Optional:

- `enabled` (Boolean)


<a id="nestedblock--options--static_response_headers"></a>
### Nested Schema for `options.static_response_headers`

Required:

- `value` (Block List, Min: 1) (see [below for nested schema](#nestedblock--options--static_response_headers--value))

Optional:

- `enabled` (Boolean)

<a id="nestedblock--options--static_response_headers--value"></a>
### Nested Schema for `options.static_response_headers.value`

Required:

- `name` (String) Header name.
- `value` (Set of String) Header value.

Optional:

- `always` (Boolean) Specifies if the header will be added to a response from CDN regardless of response code.



<a id="nestedblock--options--user_agent_acl"></a>
### Nested Schema for `options.user_agent_acl`

Required:

- `excepted_values` (Set of String) List of User-Agents. Use "" to allow/deny access when the User-Agent header is empty.
- `policy_type` (String) Possible values: allow, deny.

Optional:

- `enabled` (Boolean)


<a id="nestedblock--options--waf"></a>
### Nested Schema for `options.waf`

Required:

- `value` (Boolean)

Optional:

- `enabled` (Boolean)


<a id="nestedblock--options--websockets"></a>
### Nested Schema for `options.websockets`

Required:

- `value` (Boolean)

Optional:

- `enabled` (Boolean)
